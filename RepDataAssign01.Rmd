---
title: "Activity Monitor Data Analysis"
author: "Stephen Kaluzny"
date: "07/11/2014"
output: html_document
---

## The Data
```{r}
require("dplyr")
activity <- tbl_df(read.csv(unz("activity.zip", file="activity.csv"),
    stringsAsFactors = FALSE))
activity$date <- as.Date(activity$date)
summary(activity)
```

## Steps Per Day
We sum the number of steps for each day. 
```{r}
require("ggplot2")
activity_by_date <- group_by(activity, date)
steps_per_day <- summarise(activity_by_date, total_steps=sum(steps, na.rm=TRUE))
hist(steps_per_day$total_steps)
ggplot(steps_per_day, aes(x=total_steps)) + geom_histogram()
mean(steps_per_day$total_steps)  # mean steps per day
median(steps_per_day$total_steps)  # median steps per day
```

## Steps By Interval
```{r}
activity_by_interval <- group_by(activity, interval)
interval_average <- summarise(activity_by_interval, ave=mean(steps, na.rm=TRUE),
    med=median(steps, na.rm=TRUE))
with(interval_average, plot(interval, ave, type='l'))
```

## Missing Values

```{r}
nonmissing_steps_per_day <- summarise(activity_by_date, nonmissing=sum(!is.na(steps)))
nonmissing_steps_per_day 
```
We will replace any missing value with the mean value across all days for the same
time interval value.

Get the index (row number) where `steps` is missing.
Match the value of `interval` for theses missing rows with the value of `interval`
in the `interval_average` data frame.
Use the match index value to get the mean step value value to use in place of the
missing value.
```{r}
indxMissingDate <- which(is.na(activity$date))
indexMissingInterval <- which(is.na(activity$interval))
indxMissingSteps <- which(is.na(activity$steps))
# Number of missing values for each variable:
c(missingData=length(indxMissingDate),
  missingInterval=length(indexMissingInterval),
  missingSteps=length(indxMissingSteps))
activity_imputed <- activity
indxInterval <- match(activity[indxMissingSteps, "interval"],
   interval_average[, "interval"])
activity_imputed[indxMissingSteps, "steps"] <-
    interval_average[indxInterval, "ave"]
activity_imputed_by_date <- group_by(activity_imputed, date)
steps_imputed_per_day <- summarise(activity_imputed_by_date,
    total_steps=sum(steps, na.rm=TRUE))
ggplot(steps_imputed_per_day, aes(x=total_steps)) + geom_histogram()
mean(steps_imputed_per_day$total_steps)  # mean imputed steps per day 
median(steps_imputed_per_day$total_steps)  # median imputed steps per day
```

```{r}
table(activity$date[indxMissingSteps])
```

